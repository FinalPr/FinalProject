<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="qnaMapper">
	<resultMap id="qnaResultSet" type="QnaVO">
		<id property="qnaId" column="QID"/>
		<result property="reason" column="REASON"/>
		<result property="qnaTitle" column="QTITLE"/>
		<result property="qnaWriter" column="QWRITER"/>
		<result property="qnaContent" column="QCONTENT"/>
		<result property="areply" column="AREPLY"/>
		<result property="originalFileName" column="ORIGINALFILENAME"/>
		<result property="renameFileName" column="RENAMEFILENAME"/>
		<result property="qnaCount" column="QCOUNT"/>
		<result property="qnaCreateDate" column="Q_CREATE_DATE"/>
		<result property="qnaModifyDate" column="Q_MODIFY_DATE"/>
		<result property="qStatus" column="Q_STATUS"/>
	</resultMap>

	<select id="getListCount" resultType="_int">
		SELECT COUNT(*)
		FROM TB_QNA
		WHERE Q_STATUS='N'	
	</select>

	<select id="qnaList" resultMap="qnaResultSet">
		SELECT *
		FROM TB_QNA
		ORDER BY QID DESC
	</select>
	<insert id="insertQna" parameterType="QnaVO">
		INSERT INTO TB_QNA
		VALUES(SEQ_QID.NEXTVAL,#{reason},#{qnaTitle},#{qnaWriter},#{qnaContent},#{areply},
			   #{originalFileName},#{renameFileName},DEFAULT,SYSDATE,SYSDATE,DEFAULT)
	</insert>

	<update id="updateCount" parameterType="_int">
		UPDATE TB_QNA
		SET QCOUNT = QCOUNT +1
		WHERE QID=#{qnaId}
	</update>
	
	<select id="selectQna" resultMap="qnaResultSet">
		SELECT  *
		FROM TB_QNA
		WHERE QID=#{qnaId}
	</select>
	
	<update id="updateqna" parameterType="QnaVO">
		UPDATE TB_QNA
		SET REASON=#{reason}
			,QTITLE=#{qnaTitle}
		   ,QCONTENT=#{qnaContent}
		   ,ORIGINALFILENAME=#{originalFileName}
		   ,RENAMEFILENAME=#{renameFileName}
		   ,Q_MODIFY_DATE=SYSDATE
		WHERE QID=#{qnaId}
	</update>

	<delete id="deleteqna" parameterType="QnaVO">
		DELETE TB_QNA
		WHERE QID=#{qnaId}
	</delete>
	<select id="selectTopList" resultMap="qnaResultSet">
		<![CDATA[
		SELECT *
		FROM (SELECT *
			  FROM TB_QNA
			  ORDER BY QCOUNT desc)
		WHERE ROWNUM <= 5
		]]>
	</select>
</mapper>
